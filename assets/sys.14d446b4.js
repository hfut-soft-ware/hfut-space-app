var t=Object.defineProperty,o=(o,e)=>t(o,"name",{value:e,configurable:!0});import{l as e,m as n,p as s,$ as i,q as l,t as r,s as p,u as c,v as a,x as h,y as u,z as d,A as w,B as f,o as m,g,h as y,b as S,C as D,i as T,D as x,n as U,E as v,F as b,G as L,H as B,J as H,K as P,L as O,M as k,N as C,O as E,r as M,P as N,Q as _,d as $,R as z,S as A,T as Y,c as R,U as I}from"./index.a8d9b4eb.js";var j=Object.defineProperty,X=o(((t,o)=>j(t,"name",{value:o,configurable:!0})),"__name");function q(t){let o="function"==typeof t;const p=e({data:o?{}:t,id:null,from:null});return Promise.do((async()=>{var e,l;(null==(l=null==(e=n().pop())?void 0:e.$page)?void 0:l.fullPath)||await new Promise((t=>s(t)));let r=n().pop().$page.fullPath.split("?id=")[1];i(`${r}_query`,(t=>Object.assign(p,t))),o&&t(p.data)})).catch((t=>l.error("参数获取失败",t))),r(p)}o(q,"usePage"),X(q,"usePage");const F=Symbol("mescroll");function G(t){const o=e({enable:"all",mescroll:null,fetch:t=>setTimeout((()=>t.endSuccess(10,!1)),1e3)});p(F,o);let n=o,s=c(n,"mescroll"),i=c(n,"fetch"),l=c(n,"enable");null==t||t((t=>s.value&&s.value.onPageScroll(t))),a((()=>s.value&&s.value.onReachBottom())),h((()=>s.value&&s.value.onPullDownRefresh()));const r={onLoad:t=>(i.value=t,r),enable:t=>(l.value=t,r),mescroll:s};return r}function W(t,o){let e=this;e.version="1.3.7",e.options=t||{},e.isScrollBody=o||!1,e.isDownScrolling=!1,e.isUpScrolling=!1;let n=e.options.down&&e.options.down.callback;e.initDownScroll(),e.initUpScroll(),setTimeout((function(){(e.optDown.use||e.optDown.native)&&e.optDown.auto&&n&&(e.optDown.autoShowLoading?e.triggerDownScroll():e.optDown.callback&&e.optDown.callback(e)),e.isUpAutoLoad||setTimeout((function(){e.optUp.use&&e.optUp.auto&&!e.isUpAutoLoad&&e.triggerUpScroll()}),100)}),30)}o(G,"useScroll"),X(G,"useScroll"),o(W,"MeScroll"),W.prototype.extendDownScroll=function(t){W.extend(t,{use:!0,auto:!0,native:!1,autoShowLoading:!1,isLock:!1,offset:80,startTop:100,inOffsetRate:1,outOffsetRate:.2,bottomOffset:20,minAngle:45,textInOffset:"下拉刷新",textOutOffset:"释放更新",textLoading:"加载中 ...",textSuccess:"加载成功",textErr:"加载失败",beforeEndDelay:0,bgColor:"transparent",textColor:"gray",inited:null,inOffset:null,outOffset:null,onMoving:null,beforeLoading:null,showLoading:null,afterLoading:null,beforeEndDownScroll:null,endDownScroll:null,afterEndDownScroll:null,callback:function(t){t.resetUpScroll()}})},W.prototype.extendUpScroll=function(t){W.extend(t,{use:!0,auto:!0,isLock:!1,isBoth:!0,callback:null,page:{num:0,size:10,time:null},noMoreSize:5,offset:150,textLoading:"加载中 ...",textNoMore:"-- END --",bgColor:"transparent",textColor:"gray",inited:null,showLoading:null,showNoMore:null,hideUpScroll:null,errDistance:60,toTop:{src:null,offset:1e3,duration:300,btnClick:null,onShow:null,zIndex:9990,left:null,right:20,bottom:120,safearea:!1,width:72,radius:"50%"},empty:{use:!0,icon:null,tip:"~ 暂无相关数据 ~",btnText:"",btnClick:null,onShow:null,fixed:!1,top:"100rpx",zIndex:99},onScroll:!1})},W.extend=function(t,o){if(!t)return o;for(let e in o)if(null==t[e]){let n=o[e];t[e]=null!=n&&"object"==typeof n?W.extend({},n):n}else"object"==typeof t[e]&&W.extend(t[e],o[e]);return t},W.prototype.hasColor=function(t){if(!t)return!1;let o=t.toLowerCase();return"#fff"!=o&&"#ffffff"!=o&&"transparent"!=o&&"white"!=o},W.prototype.initDownScroll=function(){let t=this;t.optDown=t.options.down||{},!t.optDown.textColor&&t.hasColor(t.optDown.bgColor)&&(t.optDown.textColor="#fff"),t.extendDownScroll(t.optDown),t.isScrollBody&&t.optDown.native?t.optDown.use=!1:t.optDown.native=!1,t.downHight=0,t.optDown.use&&t.optDown.inited&&setTimeout((function(){t.optDown.inited(t)}),0)},W.prototype.touchstartEvent=function(t){this.optDown.use&&(this.startPoint=this.getPoint(t),this.startTop=this.getScrollTop(),this.startAngle=0,this.lastPoint=this.startPoint,this.maxTouchmoveY=this.getBodyHeight()-this.optDown.bottomOffset,this.inTouchend=!1)},W.prototype.touchmoveEvent=function(t){if(!this.optDown.use)return;let o=this,e=o.getScrollTop(),n=o.getPoint(t);if(n.y-o.startPoint.y>0&&(o.isScrollBody&&e<=0||!o.isScrollBody&&(e<=0||e<=o.optDown.startTop&&e===o.startTop))&&!o.inTouchend&&!o.isDownScrolling&&!o.optDown.isLock&&(!o.isUpScrolling||o.isUpScrolling&&o.optUp.isBoth)){if(o.startAngle||(o.startAngle=o.getAngle(o.lastPoint,n)),o.startAngle<o.optDown.minAngle)return;if(o.maxTouchmoveY>0&&n.y>=o.maxTouchmoveY)return o.inTouchend=!0,void o.touchendEvent();o.preventDefault(t);let e=n.y-o.lastPoint.y;o.downHight<o.optDown.offset?(1!==o.movetype&&(o.movetype=1,o.isDownEndSuccess=null,o.optDown.inOffset&&o.optDown.inOffset(o),o.isMoveDown=!0),o.downHight+=e*o.optDown.inOffsetRate):(2!==o.movetype&&(o.movetype=2,o.optDown.outOffset&&o.optDown.outOffset(o),o.isMoveDown=!0),o.downHight+=e>0?e*o.optDown.outOffsetRate:e),o.downHight=Math.round(o.downHight);let s=o.downHight/o.optDown.offset;o.optDown.onMoving&&o.optDown.onMoving(o,s,o.downHight)}o.lastPoint=n},W.prototype.touchendEvent=function(t){if(this.optDown.use)if(this.isMoveDown)this.downHight>=this.optDown.offset?this.triggerDownScroll():(this.downHight=0,this.endDownScrollCall(this)),this.movetype=0,this.isMoveDown=!1;else if(!this.isScrollBody&&this.getScrollTop()===this.startTop){if(this.getPoint(t).y-this.startPoint.y<0){this.getAngle(this.getPoint(t),this.startPoint)>80&&this.triggerUpScroll(!0)}}},W.prototype.getPoint=function(t){return t?t.touches&&t.touches[0]?{x:t.touches[0].pageX,y:t.touches[0].pageY}:t.changedTouches&&t.changedTouches[0]?{x:t.changedTouches[0].pageX,y:t.changedTouches[0].pageY}:{x:t.clientX,y:t.clientY}:{x:0,y:0}},W.prototype.getAngle=function(t,o){let e=Math.abs(t.x-o.x),n=Math.abs(t.y-o.y),s=Math.sqrt(e*e+n*n),i=0;return 0!==s&&(i=Math.asin(n/s)/Math.PI*180),i},W.prototype.triggerDownScroll=function(){this.optDown.beforeLoading&&this.optDown.beforeLoading(this)||(this.showDownScroll(),!this.optDown.native&&this.optDown.callback&&this.optDown.callback(this))},W.prototype.showDownScroll=function(){this.isDownScrolling=!0,this.optDown.native?(u(),this.showDownLoadingCall(0)):(this.downHight=this.optDown.offset,this.showDownLoadingCall(this.downHight))},W.prototype.showDownLoadingCall=function(t){this.optDown.showLoading&&this.optDown.showLoading(this,t),this.optDown.afterLoading&&this.optDown.afterLoading(this,t)},W.prototype.onPullDownRefresh=function(){this.isDownScrolling=!0,this.showDownLoadingCall(0),this.optDown.callback&&this.optDown.callback(this)},W.prototype.endDownScroll=function(){if(this.optDown.native)return this.isDownScrolling=!1,this.endDownScrollCall(this),void d();let t=this,e=o((function(){t.downHight=0,t.isDownScrolling=!1,t.endDownScrollCall(t),t.isScrollBody||(t.setScrollHeight(0),t.scrollTo(0,0))}),"endScroll"),n=0;t.optDown.beforeEndDownScroll&&(n=t.optDown.beforeEndDownScroll(t),null==t.isDownEndSuccess&&(n=0)),"number"==typeof n&&n>0?setTimeout(e,n):e()},W.prototype.endDownScrollCall=function(){this.optDown.endDownScroll&&this.optDown.endDownScroll(this),this.optDown.afterEndDownScroll&&this.optDown.afterEndDownScroll(this)},W.prototype.lockDownScroll=function(t){null==t&&(t=!0),this.optDown.isLock=t},W.prototype.lockUpScroll=function(t){null==t&&(t=!0),this.optUp.isLock=t},W.prototype.initUpScroll=function(){let t=this;t.optUp=t.options.up||{use:!1},!t.optUp.textColor&&t.hasColor(t.optUp.bgColor)&&(t.optUp.textColor="#fff"),t.extendUpScroll(t.optUp),!1!==t.optUp.use&&(t.optUp.hasNext=!0,t.startNum=t.optUp.page.num+1,t.optUp.inited&&setTimeout((function(){t.optUp.inited(t)}),0))},W.prototype.onReachBottom=function(){this.isScrollBody&&!this.isUpScrolling&&!this.optUp.isLock&&this.optUp.hasNext&&this.triggerUpScroll()},W.prototype.onPageScroll=function(t){this.isScrollBody&&(this.setScrollTop(t.scrollTop),t.scrollTop>=this.optUp.toTop.offset?this.showTopBtn():this.hideTopBtn())},W.prototype.scroll=function(t,o){this.setScrollTop(t.scrollTop),this.setScrollHeight(t.scrollHeight),null==this.preScrollY&&(this.preScrollY=0),this.isScrollUp=t.scrollTop-this.preScrollY>0,this.preScrollY=t.scrollTop,this.isScrollUp&&this.triggerUpScroll(!0),t.scrollTop>=this.optUp.toTop.offset?this.showTopBtn():this.hideTopBtn(),this.optUp.onScroll&&o&&o()},W.prototype.triggerUpScroll=function(t){if(!this.isUpScrolling&&this.optUp.use&&this.optUp.callback){if(!0===t){let t=!1;if(!this.optUp.hasNext||this.optUp.isLock||this.isDownScrolling||this.getScrollBottom()<=this.optUp.offset&&(t=!0),!1===t)return}this.showUpScroll(),this.optUp.page.num++,this.isUpAutoLoad=!0,this.num=this.optUp.page.num,this.size=this.optUp.page.size,this.time=this.optUp.page.time,this.optUp.callback(this)}},W.prototype.showUpScroll=function(){this.isUpScrolling=!0,this.optUp.showLoading&&this.optUp.showLoading(this)},W.prototype.showNoMore=function(){this.optUp.hasNext=!1,this.optUp.showNoMore&&this.optUp.showNoMore(this)},W.prototype.hideUpScroll=function(){this.optUp.hideUpScroll&&this.optUp.hideUpScroll(this)},W.prototype.endUpScroll=function(t){null!=t&&(t?this.showNoMore():this.hideUpScroll()),this.isUpScrolling=!1},W.prototype.resetUpScroll=function(t){if(this.optUp&&this.optUp.use){let o=this.optUp.page;this.prePageNum=o.num,this.prePageTime=o.time,o.num=this.startNum,o.time=null,this.isDownScrolling||!1===t||(null==t?(this.removeEmpty(),this.showUpScroll()):this.showDownScroll()),this.isUpAutoLoad=!0,this.num=o.num,this.size=o.size,this.time=o.time,this.optUp.callback&&this.optUp.callback(this)}},W.prototype.setPageNum=function(t){this.optUp.page.num=t-1},W.prototype.setPageSize=function(t){this.optUp.page.size=t},W.prototype.endByPage=function(t,o,e){let n;this.optUp.use&&null!=o&&(n=this.optUp.page.num<o),this.endSuccess(t,n,e)},W.prototype.endBySize=function(t,o,e){let n;if(this.optUp.use&&null!=o){n=(this.optUp.page.num-1)*this.optUp.page.size+t<o}this.endSuccess(t,n,e)},W.prototype.endSuccess=function(t,o,e){let n=this;if(n.isDownScrolling&&(n.isDownEndSuccess=!0,n.endDownScroll()),n.optUp.use){let s;if(null!=t){let i=n.optUp.page.num,l=n.optUp.page.size;if(1===i&&e&&(n.optUp.page.time=e),t<l||!1===o)if(n.optUp.hasNext=!1,0===t&&1===i)s=!1,n.showEmpty();else{s=!((i-1)*l+t<n.optUp.noMoreSize),n.removeEmpty()}else s=!1,n.optUp.hasNext=!0,n.removeEmpty()}n.endUpScroll(s)}},W.prototype.endErr=function(t){if(this.isDownScrolling){this.isDownEndSuccess=!1;let t=this.optUp.page;t&&this.prePageNum&&(t.num=this.prePageNum,t.time=this.prePageTime),this.endDownScroll()}this.isUpScrolling&&(this.optUp.page.num--,this.endUpScroll(!1),this.isScrollBody&&0!==t&&(t||(t=this.optUp.errDistance),this.scrollTo(this.getScrollTop()-t,0)))},W.prototype.showEmpty=function(){this.optUp.empty.use&&this.optUp.empty.onShow&&this.optUp.empty.onShow(!0)},W.prototype.removeEmpty=function(){this.optUp.empty.use&&this.optUp.empty.onShow&&this.optUp.empty.onShow(!1)},W.prototype.showTopBtn=function(){this.topBtnShow||(this.topBtnShow=!0,this.optUp.toTop.onShow&&this.optUp.toTop.onShow(!0))},W.prototype.hideTopBtn=function(){this.topBtnShow&&(this.topBtnShow=!1,this.optUp.toTop.onShow&&this.optUp.toTop.onShow(!1))},W.prototype.getScrollTop=function(){return this.scrollTop||0},W.prototype.setScrollTop=function(t){this.scrollTop=t},W.prototype.scrollTo=function(t,o){this.myScrollTo&&this.myScrollTo(t,o)},W.prototype.resetScrollTo=function(t){this.myScrollTo=t},W.prototype.getScrollBottom=function(){return this.getScrollHeight()-this.getClientHeight()-this.getScrollTop()},W.prototype.getStep=function(t,o,e,n,s){let i=o-t;if(0===n||0===i)return void(e&&e(o));let l=(n=n||300)/(s=s||30),r=i/l,p=0,c=setInterval((function(){p<l-1?(t+=r,e&&e(t,c),p++):(e&&e(o,c),clearInterval(c))}),s)},W.prototype.getClientHeight=function(t){let o=this.clientHeight||0;return 0===o&&!0!==t&&(o=this.getBodyHeight()),o},W.prototype.setClientHeight=function(t){this.clientHeight=t},W.prototype.getScrollHeight=function(){return this.scrollHeight||0},W.prototype.setScrollHeight=function(t){this.scrollHeight=t},W.prototype.getBodyHeight=function(){return this.bodyHeight||0},W.prototype.setBodyHeight=function(t){this.bodyHeight=t},W.prototype.preventDefault=function(t){t&&t.cancelable&&!t.defaultPrevented&&t.preventDefault()};const J={down:{offset:80,native:!1},up:{offset:150,toTop:{src:"https://www.mescroll.com/img/mescroll-totop.png",offset:1e3,right:20,bottom:120,width:72},empty:{use:!0,icon:"https://www.mescroll.com/img/mescroll-empty.png"}},i18n:{zh:{down:{textInOffset:"下拉刷新",textOutOffset:"释放更新",textLoading:"加载中 ...",textSuccess:"加载成功",textErr:"加载失败"},up:{textLoading:"加载中 ...",textNoMore:"-- END --",empty:{tip:"~ 空空如也 ~"}}},en:{down:{textInOffset:"drop down refresh",textOutOffset:"release updates",textLoading:"loading ...",textSuccess:"loaded successfully",textErr:"loading failed"},up:{textLoading:"loading ...",textNoMore:"-- END --",empty:{tip:"~ absolutely empty ~"}}}}},V={def:"zh",getType(){return w("mescroll-i18n")||this.def},setType(t){f("mescroll-i18n",t)}};var K=o(((t,o)=>{const e=t.__vccOpts||t;for(const[n,s]of o)e[n]=s;return e}),"_export_sfc");const Q={props:{option:{type:Object,default:()=>({})}},computed:{icon(){if(null!=this.option.icon)return this.option.icon;{let t=V.getType();return this.option.i18n?this.option.i18n[t].icon:J.i18n[t].up.empty.icon||J.up.empty.icon}},tip(){if(null!=this.option.tip)return this.option.tip;{let t=V.getType();return this.option.i18n?this.option.i18n[t].tip:J.i18n[t].up.empty.tip||J.up.empty.tip}},btnText(){if(this.option.i18n){let t=V.getType();return this.option.i18n[t].btnText}return this.option.btnText}},methods:{emptyClick(){this.$emit("emptyclick")}}};function Z(t,o,e,n,s,i){const l=b,r=L;return m(),g(r,{class:U(["mescroll-empty",{"empty-fixed":e.option.fixed}]),style:v({"z-index":e.option.zIndex,top:e.option.top})},{default:y((()=>[S(r,null,{default:y((()=>[i.icon?(m(),g(l,{key:0,class:"empty-icon",src:i.icon,mode:"widthFix"},null,8,["src"])):D("v-if",!0)])),_:1}),i.tip?(m(),g(r,{key:0,class:"empty-tip"},{default:y((()=>[T(x(i.tip),1)])),_:1})):D("v-if",!0),i.btnText?(m(),g(r,{key:1,class:"empty-btn",onClick:i.emptyClick},{default:y((()=>[T(x(i.btnText),1)])),_:1},8,["onClick"])):D("v-if",!0)])),_:1},8,["class","style"])}o(Z,"_sfc_render$2");var tt=K(Q,[["render",Z],["__scopeId","data-v-52abc8f8"]]);const ot={props:{option:Object,value:!1},computed:{mOption(){return this.option||{}},left(){return this.mOption.left?this.addUnit(this.mOption.left):"auto"},right(){return this.mOption.left?"auto":this.addUnit(this.mOption.right)}},methods:{addUnit:t=>t?"number"==typeof t?t+"rpx":t:0,toTopClick(){this.$emit("input",!1),this.$emit("click")}}};function et(t,o,e,n,s,i){const l=b;return i.mOption.src?(m(),g(l,{key:0,class:U(["mescroll-totop",[e.value?"mescroll-totop-in":"mescroll-totop-out",{"mescroll-totop-safearea":i.mOption.safearea}]]),style:v({"z-index":i.mOption.zIndex,left:i.left,right:i.right,bottom:i.addUnit(i.mOption.bottom),width:i.addUnit(i.mOption.width),"border-radius":i.addUnit(i.mOption.radius)}),src:i.mOption.src,mode:"widthFix",onClick:i.toTopClick},null,8,["class","style","src","onClick"])):D("v-if",!0)}o(et,"_sfc_render$1");var nt=K(ot,[["render",et],["__scopeId","data-v-2b2af46f"]]);const st={data:()=>({wxsProp:{optDown:{},scrollTop:0,bodyHeight:0,isDownScrolling:!1,isUpScrolling:!1,isScrollBody:!0,isUpBoth:!0,t:0},callProp:{callType:"",t:0}}),methods:{wxsCall(t){"setWxsProp"===t.type?this.wxsProp={optDown:this.mescroll.optDown,scrollTop:this.mescroll.getScrollTop(),bodyHeight:this.mescroll.getBodyHeight(),isDownScrolling:this.mescroll.isDownScrolling,isUpScrolling:this.mescroll.isUpScrolling,isUpBoth:this.mescroll.optUp.isBoth,isScrollBody:this.mescroll.isScrollBody,t:Date.now()}:"setLoadType"===t.type?(this.downLoadType=t.downLoadType,this.$set(this.mescroll,"downLoadType",this.downLoadType),this.$set(this.mescroll,"isDownEndSuccess",null)):"triggerDownScroll"===t.type?this.mescroll.triggerDownScroll():"endDownScroll"===t.type?this.mescroll.endDownScroll():"triggerUpScroll"===t.type&&this.mescroll.triggerUpScroll(!0)}},mounted(){this.mescroll.optDown.afterLoading=()=>{this.callProp={callType:"showLoading",t:Date.now()}},this.mescroll.optDown.afterEndDownScroll=()=>{this.callProp={callType:"endDownScroll",t:Date.now()};let t=300+(this.mescroll.optDown.beforeEndDelay||0);setTimeout((()=>{4!==this.downLoadType&&0!==this.downLoadType||(this.callProp={callType:"clearTransform",t:Date.now()}),this.$set(this.mescroll,"downLoadType",this.downLoadType)}),t)},this.wxsCall({type:"setWxsProp"})}};var it={};function lt(t){it.optDown=t.optDown,it.scrollTop=t.scrollTop,it.bodyHeight=t.bodyHeight,it.isDownScrolling=t.isDownScrolling,it.isUpScrolling=t.isUpScrolling,it.isUpBoth=t.isUpBoth,it.isScrollBody=t.isScrollBody,it.startTop=t.scrollTop}function rt(t,o,e){it.disabled()||t.callType&&("showLoading"===t.callType?it.showLoading(e):"endDownScroll"===t.callType?it.endDownScroll(e):"clearTransform"===t.callType&&it.clearTransform(e))}function pt(t,o){it.downHight=0,it.startPoint=it.getPoint(t),it.startTop=it.getScrollTop(),it.startAngle=0,it.lastPoint=it.startPoint,it.maxTouchmoveY=it.getBodyHeight()-it.optDown.bottomOffset,it.inTouchend=!1,it.callMethod(o,{type:"setWxsProp"})}function ct(t,o){var e=!0;if(it.disabled())return e;var n=it.getScrollTop(),s=it.getPoint(t);if(s.y-it.startPoint.y>0&&(it.isScrollBody&&n<=0||!it.isScrollBody&&(n<=0||n<=it.optDown.startTop&&n===it.startTop))&&!it.inTouchend&&!it.isDownScrolling&&!it.optDown.isLock&&(!it.isUpScrolling||it.isUpScrolling&&it.isUpBoth)){if(it.startAngle||(it.startAngle=it.getAngle(it.lastPoint,s)),it.startAngle<it.optDown.minAngle)return e;if(it.maxTouchmoveY>0&&s.y>=it.maxTouchmoveY)return it.inTouchend=!0,at(t,o),e;e=!1;var i=s.y-it.lastPoint.y;it.downHight<it.optDown.offset?(1!==it.movetype&&(it.movetype=1,it.callMethod(o,{type:"setLoadType",downLoadType:1}),it.isMoveDown=!0),it.downHight+=i*it.optDown.inOffsetRate):(2!==it.movetype&&(it.movetype=2,it.callMethod(o,{type:"setLoadType",downLoadType:2}),it.isMoveDown=!0),it.downHight+=i>0?i*it.optDown.outOffsetRate:i),it.downHight=Math.round(it.downHight);var l=it.downHight/it.optDown.offset;it.onMoving(o,l,it.downHight)}return it.lastPoint=s,e}function at(t,o){if(it.isMoveDown)it.downHight>=it.optDown.offset?(it.downHight=it.optDown.offset,it.callMethod(o,{type:"triggerDownScroll"})):(it.downHight=0,it.callMethod(o,{type:"endDownScroll"})),it.movetype=0,it.isMoveDown=!1;else if(!it.isScrollBody&&it.getScrollTop()===it.startTop){if(it.getPoint(t).y-it.startPoint.y<0)it.getAngle(it.getPoint(t),it.startPoint)>80&&it.callMethod(o,{type:"triggerUpScroll"})}it.callMethod(o,{type:"setWxsProp"})}it.onMoving=function(t,o,e){t.requestAnimationFrame((function(){t.selectComponent(".mescroll-wxs-content").setStyle({"will-change":"transform",transform:"translateY("+e+"px)",transition:""});var n=t.selectComponent(".mescroll-wxs-progress");n&&n.setStyle({transform:"rotate("+360*o+"deg)"})}))},it.showLoading=function(t){it.downHight=it.optDown.offset,t.requestAnimationFrame((function(){t.selectComponent(".mescroll-wxs-content").setStyle({"will-change":"auto",transform:"translateY("+it.downHight+"px)",transition:"transform 300ms"})}))},it.endDownScroll=function(t){it.downHight=0,it.isDownScrolling=!1,t.requestAnimationFrame((function(){t.selectComponent(".mescroll-wxs-content").setStyle({"will-change":"auto",transform:"translateY(0)",transition:"transform 300ms"})}))},it.clearTransform=function(t){t.requestAnimationFrame((function(){t.selectComponent(".mescroll-wxs-content").setStyle({"will-change":"",transform:"",transition:""})}))},o(lt,"propObserver$1"),o(rt,"callObserver"),o(pt,"touchstartEvent"),o(ct,"touchmoveEvent"),o(at,"touchendEvent"),it.disabled=function(){return!it.optDown||!it.optDown.use||it.optDown.native},it.getPoint=function(t){return t?t.touches&&t.touches[0]?{x:t.touches[0].pageX,y:t.touches[0].pageY}:t.changedTouches&&t.changedTouches[0]?{x:t.changedTouches[0].pageX,y:t.changedTouches[0].pageY}:{x:t.clientX,y:t.clientY}:{x:0,y:0}},it.getAngle=function(t,o){var e=Math.abs(t.x-o.x),n=Math.abs(t.y-o.y),s=Math.sqrt(e*e+n*n),i=0;return 0!==s&&(i=Math.asin(n/s)/Math.PI*180),i},it.getScrollTop=function(){return it.scrollTop||0},it.getBodyHeight=function(){return it.bodyHeight||0},it.callMethod=function(t,o){t&&t.callMethod("wxsCall",o)};const ht={propObserver:lt,callObserver:rt,touchstartEvent:pt,touchmoveEvent:ct,touchendEvent:at};var ut=o((t=>{t.$wxs||(t.$wxs=[]),t.$wxs.push("wxsBiz"),t.mixins||(t.mixins=[]),t.mixins.push({beforeCreate(){this.wxsBiz=ht}})}),"block0"),dt={};function wt(t){dt.optDown=t.optDown,dt.scrollTop=t.scrollTop,dt.isDownScrolling=t.isDownScrolling,dt.isUpScrolling=t.isUpScrolling,dt.isUpBoth=t.isUpBoth}window&&!window.$mescrollRenderInit&&(window.$mescrollRenderInit=!0,window.addEventListener("touchstart",(function(t){dt.disabled()||(dt.startPoint=dt.getPoint(t))}),{passive:!0}),window.addEventListener("touchmove",(function(t){if(!dt.disabled()&&(!(dt.getScrollTop()>0)&&dt.getPoint(t).y-dt.startPoint.y>0&&!dt.isDownScrolling&&!dt.optDown.isLock&&(!dt.isUpScrolling||dt.isUpScrolling&&dt.isUpBoth))){for(var o=t.target,e=!1;o&&o.tagName&&"UNI-PAGE-BODY"!==o.tagName&&"BODY"!=o.tagName;){var n=o.classList;if(n&&n.contains("mescroll-render-touch")){e=!0;break}o=o.parentNode}e&&t.cancelable&&!t.defaultPrevented&&t.preventDefault()}}),{passive:!1})),dt.getScrollTop=function(){return dt.scrollTop||0},dt.disabled=function(){return!dt.optDown||!dt.optDown.use||dt.optDown.native},dt.getPoint=function(t){return t?t.touches&&t.touches[0]?{x:t.touches[0].pageX,y:t.touches[0].pageY}:t.changedTouches&&t.changedTouches[0]?{x:t.changedTouches[0].pageX,y:t.changedTouches[0].pageY}:{x:t.clientX,y:t.clientY}:{x:0,y:0}},o(wt,"propObserver");const ft={mixins:[{data:()=>({propObserver:wt})}]};var mt=o((t=>{t.$renderjs||(t.$renderjs=[]),t.$renderjs.push("renderBiz"),t.mixins||(t.mixins=[]),t.mixins.push({beforeCreate(){this.renderBiz=this},mounted(){this.$ownerInstance=this.$gcd(this,!0)}}),t.mixins.push(ft)}),"block1");const gt={name:"mescroll-body",mixins:[st],components:{MescrollEmpty:tt,MescrollTop:nt},props:{down:Object,up:Object,i18n:Object,top:[String,Number],topbar:[Boolean,String],bottom:[String,Number],safearea:Boolean,height:[String,Number],bottombar:{type:Boolean,default:!0},sticky:Boolean},data:()=>({mescroll:{optDown:{},optUp:{}},downHight:0,downRate:0,downLoadType:0,upLoadType:0,isShowEmpty:!1,isShowToTop:!1,windowHeight:0,windowBottom:0,statusBarHeight:0}),computed:{minHeight(){return this.toPx(this.height||"100%")+"px"},numTop(){return this.toPx(this.top)},padTop(){return this.numTop+"px"},numBottom(){return this.toPx(this.bottom)},padBottom(){return this.numBottom+"px"},isDownReset(){return 3===this.downLoadType||4===this.downLoadType},transition(){return this.isDownReset?"transform 300ms":""},translateY(){return this.downHight>0?"translateY("+this.downHight+"px)":""},isDownLoading(){return 3===this.downLoadType},downRotate(){return"rotate("+360*this.downRate+"deg)"},downText(){if(!this.mescroll)return"";switch(this.downLoadType){case 1:default:return this.mescroll.optDown.textInOffset;case 2:return this.mescroll.optDown.textOutOffset;case 3:return this.mescroll.optDown.textLoading;case 4:return this.mescroll.isDownEndSuccess?this.mescroll.optDown.textSuccess:0==this.mescroll.isDownEndSuccess?this.mescroll.optDown.textErr:this.mescroll.optDown.textInOffset}}},methods:{toPx(t){if("string"==typeof t)if(-1!==t.indexOf("px"))if(-1!==t.indexOf("rpx"))t=t.replace("rpx","");else{if(-1===t.indexOf("upx"))return Number(t.replace("px",""));t=t.replace("upx","")}else if(-1!==t.indexOf("%")){let o=Number(t.replace("%",""))/100;return this.windowHeight*o}return t?B(Number(t)):0},emptyClick(){this.$emit("emptyclick",this.mescroll)},toTopClick(){this.mescroll.scrollTo(0,this.mescroll.optUp.toTop.duration),this.$emit("topclick",this.mescroll)}},created(){let t=this,o={down:{inOffset(){t.downLoadType=1},outOffset(){t.downLoadType=2},onMoving(o,e,n){t.downHight=n,t.downRate=e},showLoading(o,e){t.downLoadType=3,t.downHight=e},beforeEndDownScroll:o=>(t.downLoadType=4,o.optDown.beforeEndDelay),endDownScroll(){t.downLoadType=4,t.downHight=0,t.downResetTimer&&(clearTimeout(t.downResetTimer),t.downResetTimer=null),t.downResetTimer=setTimeout((()=>{4===t.downLoadType&&(t.downLoadType=0)}),300)},callback:function(o){t.$emit("down",o)}},up:{showLoading(){t.upLoadType=1},showNoMore(){t.upLoadType=2},hideUpScroll(o){t.upLoadType=o.optUp.hasNext?0:3},empty:{onShow(o){t.isShowEmpty=o}},toTop:{onShow(o){t.isShowToTop=o}},callback:function(o){t.$emit("up",o)}}},e=V.getType(),n={type:e};W.extend(n,t.i18n),W.extend(n,J.i18n),W.extend(o,n[e]),W.extend(o,{down:J.down,up:J.up});let s=JSON.parse(JSON.stringify({down:t.down,up:t.up}));W.extend(s,o),t.mescroll=new W(s,!0),t.mescroll.i18n=n,t.$emit("init",t.mescroll);const i=H();i.windowHeight&&(t.windowHeight=i.windowHeight),i.windowBottom&&(t.windowBottom=i.windowBottom),i.statusBarHeight&&(t.statusBarHeight=i.statusBarHeight),t.mescroll.setBodyHeight(i.windowHeight),t.mescroll.resetScrollTo(((o,e)=>{"string"==typeof o?setTimeout((()=>{let n;-1==o.indexOf("#")&&-1==o.indexOf(".")?n="#"+o:(n=o,-1!=o.indexOf(">>>")&&(n=o.split(">>>")[1].trim())),P().select(n).boundingClientRect((function(o){if(o){let n=o.top;n+=t.mescroll.getScrollTop(),O({scrollTop:n,duration:e})}else console.error(n+" does not exist")})).exec()}),30):O({scrollTop:o,duration:e})})),t.up&&t.up.toTop&&null!=t.up.toTop.safearea||(t.mescroll.optUp.toTop.safearea=t.safearea),k("setMescrollGlobalOption",(o=>{if(!o)return;let e=o.i18n?o.i18n.type:null;if(e&&t.mescroll.i18n.type!=e&&(t.mescroll.i18n.type=e,V.setType(e),W.extend(o,t.mescroll.i18n[e])),o.down){let e=W.extend({},o.down);t.mescroll.optDown=W.extend(e,t.mescroll.optDown)}if(o.up){let e=W.extend({},o.up);t.mescroll.optUp=W.extend(e,t.mescroll.optUp)}}))},destroyed(){C("setMescrollGlobalOption")}};function yt(t,o,e,n,s,i){const l=L,r=E("mescroll-empty"),p=E("mescroll-top");return m(),g(l,{class:U(["mescroll-body mescroll-render-touch",{"mescorll-sticky":e.sticky}]),style:v({minHeight:i.minHeight,"padding-top":i.padTop,"padding-bottom":i.padBottom}),onTouchstart:t.wxsBiz.touchstartEvent,onTouchmove:t.wxsBiz.touchmoveEvent,onTouchend:t.wxsBiz.touchendEvent,onTouchcancel:t.wxsBiz.touchendEvent,"change:prop":t.wxsBiz.propObserver,prop:t.wxsProp},{default:y((()=>[D(" 状态栏 "),e.topbar&&s.statusBarHeight?(m(),g(l,{key:0,class:"mescroll-topbar",style:v({height:s.statusBarHeight+"px",background:e.topbar})},null,8,["style"])):D("v-if",!0),S(l,{class:"mescroll-body-content mescroll-wxs-content",style:v({transform:i.translateY,transition:i.transition}),"change:prop":t.wxsBiz.callObserver,prop:t.callProp},{default:y((()=>[D(" 下拉加载区域 (支付宝小程序子组件传参给子子组件仍报单项数据流的异常,暂时不通过mescroll-down组件实现)"),D(' <mescroll-down :option="mescroll.optDown" :type="downLoadType" :rate="downRate"></mescroll-down> '),s.mescroll.optDown.use?(m(),g(l,{key:0,class:"mescroll-downwarp",style:v({background:s.mescroll.optDown.bgColor,color:s.mescroll.optDown.textColor})},{default:y((()=>[S(l,{class:"downwarp-content"},{default:y((()=>[S(l,{class:U(["downwarp-progress mescroll-wxs-progress",{"mescroll-rotate":i.isDownLoading}]),style:v({"border-color":s.mescroll.optDown.textColor,transform:i.downRotate})},null,8,["class","style"]),S(l,{class:"downwarp-tip"},{default:y((()=>[T(x(i.downText),1)])),_:1})])),_:1})])),_:1},8,["style"])):D("v-if",!0),D(" 列表内容 "),M(t.$slots,"default",{},void 0,!0),D(" 空布局 "),s.isShowEmpty?(m(),g(r,{key:1,option:s.mescroll.optUp.empty,onEmptyclick:i.emptyClick},null,8,["option","onEmptyclick"])):D("v-if",!0),D(" 上拉加载区域 (下拉刷新时不显示, 支付宝小程序子组件传参给子子组件仍报单项数据流的异常,暂时不通过mescroll-up组件实现)"),D(' <mescroll-up v-if="mescroll.optUp.use && !isDownLoading && upLoadType!==3" :option="mescroll.optUp" :type="upLoadType"></mescroll-up> '),s.mescroll.optUp.use&&!i.isDownLoading&&3!==s.upLoadType?(m(),g(l,{key:2,class:"mescroll-upwarp",style:v({background:s.mescroll.optUp.bgColor,color:s.mescroll.optUp.textColor})},{default:y((()=>[D(" 加载中 (此处不能用v-if,否则android小程序快速上拉可能会不断触发上拉回调) "),N(S(l,null,{default:y((()=>[S(l,{class:"upwarp-progress mescroll-rotate",style:v({"border-color":s.mescroll.optUp.textColor})},null,8,["style"]),S(l,{class:"upwarp-tip"},{default:y((()=>[T(x(s.mescroll.optUp.textLoading),1)])),_:1})])),_:1},512),[[_,1===s.upLoadType]]),D(" 无数据 "),2===s.upLoadType?(m(),g(l,{key:0,class:"upwarp-nodata"},{default:y((()=>[T(x(s.mescroll.optUp.textNoMore),1)])),_:1})):D("v-if",!0)])),_:1},8,["style"])):D("v-if",!0)])),_:3},8,["style","change:prop","prop"]),D(" 底部是否偏移TabBar的高度(默认仅在H5端的tab页生效) "),e.bottombar&&s.windowBottom>0?(m(),g(l,{key:1,class:"mescroll-bottombar",style:v({height:s.windowBottom+"px"})},null,8,["style"])):D("v-if",!0),D(" 适配iPhoneX "),e.safearea?(m(),g(l,{key:2,class:"mescroll-safearea"})):D("v-if",!0),D(" 回到顶部按钮 (fixed元素需写在transform外面,防止降级为absolute)"),S(p,{modelValue:s.isShowToTop,"onUpdate:modelValue":o[0]||(o[0]=t=>s.isShowToTop=t),option:s.mescroll.optUp.toTop,onClick:i.toTopClick},null,8,["modelValue","option","onClick"]),D(" renderjs的数据载体,不可写在mescroll-downwarp内部,避免use为false时,载体丢失,无法更新数据 "),S(l,{"change:prop":t.renderBiz.propObserver,prop:t.wxsProp},null,8,["change:prop","prop"])])),_:3},8,["class","style","onTouchstart","onTouchmove","onTouchend","onTouchcancel","change:prop","prop"])}o(yt,"_sfc_render"),"function"==typeof ut&&ut(gt),"function"==typeof mt&&mt(gt);var St=K(gt,[["render",yt],["__scopeId","data-v-6f774954"]]);const Dt=$({inheritAttrs:!1,__name:"sys",setup(t){const o=q(),e=c(o,"id");z((()=>C(`${e.value}_resolve`))),z((()=>C(`${e.value}_reject`))),z((()=>C(`${e.value}_query`)));const n=A(F,{}),s=c(n,"mescroll"),i=c(n,"fetch"),l=c(n,"enable");let r=Y((()=>["all","up"].some((t=>t==l.value)))),p=Y((()=>["all","down"].some((t=>t==l.value))));return(t,o)=>(m(),R(I,null,[D(" 本组件将由uni-provider插件自动混入到每一个页面中 "),S(St,{up:{use:r.value},down:{use:p.value},onInit:o[0]||(o[0]=t=>s.value=t),onUp:i.value,onDown:o[1]||(o[1]=t=>r.value?t.resetUpScroll():i.value(t))},{default:y((()=>[M(t.$slots,"default")])),_:3},8,["up","down","onUp"]),M(t.$slots,"fixed")],64))}});export{K as _,Dt as a};
